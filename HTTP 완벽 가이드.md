---
title: HTTP 완벽 가이드
categories: http
tags:
---

# Ch01. HTTP 개관

## HTTP(Hypertext Transfer Protocol)

### 웹 클라이언트와 서버

* HTTP 클라이언트와 HTTP 서버는 WWW 의 기본 요소

### 리소스

* 웹 서버는 웹 리소스를 관리하고 제공한다. 웹 리소스는 다음과 같이 다양하다.
  * 텍스트, HTML, 이미지 등의 웹 서버상 파일 시스템의 정적 파일
  * 요청에 따라 동적으로 생성되는 컨텐츠 (게이트웨이)

### 미디어 타입

* 수 많은 데이터 타입을 처리하기 위해 웹에서 전송되는 객체 각각에 MIME 타입을 붙임 (Multipurpose Internet Mail Extensions)
* 브라우저는 MIME 타입을 통해 서버로부터 받은 객체를 처리할 수 있는지 판단한다.
* [주타입]/[부타입] 의 양식을 갖는다.
  * ex. text/html, text/plain, image/jpeg, application/vnd.ms-powerpoint

### URI (Uniform Resource Identifier)

* 웹 리소스를 고유하게 식별하고 위치를 지정하는 주소
* 크게 URL, URN이 있다. 관례상 자주 쓰이는 URL이 URI와 같은 의미로 쓰이기도 한다.

1. URL(Uniform Resource Locator)
* http://naver.com/images/blog-icon.jpg 를 해석하면
  * http:// -> http 프로토콜을 사용하라
  * naver.com -> naver.com 에서
  * /images/blog-icon.jpg -> 이라 불리는 리소스를 가져와라
* 즉, 세 부분으로 구성된다.
  1. scheme : 리소스에 접근하기 위해 사용하는 프로토콜
  2. 서버의 인터넷 주소
  3. 웹 서버의 리소스

2. URN(Uniform Resource Name)
* 한 리소스에 대해 리소스의 실제 위치에 영향을 받지 않는 유일무이한 이름을 제공한다.
* 예를들어 `urn:ietf:rfc:2141` 이란 주소는 리소스가 실제로 어느 서버에 있던 간에 RFC 2141 이 어디에 있는지를 지칭한다.
* 하지만 널리 쓰이지 않는다.

### 1.4 트랜잭션

* HTTP 트랜잭션은 HTTP 요청과 응답으로 구성된다.

#### 1.4.1 메서드

* 서버에게 어떤 동작이 취해져야 하는지 알리는 요청 명령

HTTP 메서드|설명
-|-
GET|서버에서 클라이언트로 지정한 리소스를 보내라 
PUT|클라이언트에서 서버로 보낸 데이터를 지정한 이름의 리소스로 저장하라
DELETE|지정한 리소스를 서버에서 삭제하라
POST|클라이언트 데이터를 서버 게이트웨이 애플리케이션으로 보내라
HEAD|지정한 리소스에 대한 응답에서 HTTP 헤더 부분만 보내라

#### 1.4.2 상태 코드

* 클라이언트에게 요청이 성공했는지 아니면 추가 조치가 필요한지 알려주는 세 자리 숫자

HTTP 상태 코드|설명
-|-
200|정상
302|redirect
404|리소스를 찾을 수 없음

* 보통 `200 OK` 와 같이  숫자 상태 코드와 사유 구절이 같이 오는데 사유 구절은 단지 설명을 위한 값이다.

### 1.5 메시지

* HTTP 메시지는 단순한 줄 단위의 문자열이다.
* 요청 메시지 예
```
GET /test/hi.txt HTTP/1.1
Accept: test/*
Accept-Language: ko
```
* 응답 메시지 예
```
HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 19

Hi!
```

* 의미는 아래와 같다
* 시작줄
  * 메시지의 첫 줄. 요청일 때는 무엇을 해야 하는지, 응답일 때는 무슨 일이 일어났는지 나타냄
* 헤더
  * 시작줄 다음에 오는 0개 이상의 헤더 필드. 한 줄당 하나의 헤더가 오며 하나의 헤더는 `:`을 구분자로 하나의 이름과 하나의 값으로 구성된다. 헤더는 빈 줄로 끝난다.
* 본문
  * 필요에 따라 존재한다.
  * 본문은 이진 데이터, 텍스트를 모두 포함할 수 있다.

### 1.6 TCP 커넥션

* HTTP는 애플리케이션 계층 프로토콜이며 신뢰성있는 데이터 전송을 위해 TCP/IP 프로토콜 위에서 동작한다.
* TCP는 다음을 제공한다.
  * 오류 없는 데이터 전송
  * 보낸 순서대로 전달
  * 조각나지 않는 데이터 스트림 (언제든 어떤 크기로든 전송 가능)
* URL을 통해 HTTP 트랜잭션이 이루어지는 과정 `ex) http://google.com/index.html`
  1. 브라우저가 서버의 URL에서 호스트 명을 추출 (google.com)
  2. 브라우저가 서버의 호스트 명을 IP로 변환 (172.217.26.14)
  3. 브라우저가 URL에서 포트번호를 추출 (생략되었으므로 프로토콜에서 80 유추)
  4. 브라우저가 웹 서버와 TCP 커넥션을 맺음
  5. 브라우저가 서버에 HTTP 요청을 보냄
  6. 서버가 브라우저에 HTTP 응답을 돌려줌
  7. 커넥션이 닫히면 브라우저는 문서를 표시함
```bash
# telnet을 이용해서 직접 해보기
# 1~4 까지 진행하여 TCP 커넥션 맺음
telent www.google.com 80
# 5. HTTP 요청 보냄 (헤더의 끝을 알리기 위해 Host 헤더 라인 끝에서 엔터 두 번)
GET /index.html HTTP/1.1
Host: www.google.com

# 6~7 HTTP 응답 수신 및 표시
HTTP/1.1 301 Moved Permanently
Location: http://www.google.com/index.html
Content-Type: text/html; charset=UTF-8
... 이하 생략 ...
```

### 1.7 프로토콜 버전

* `HTTP/0.9`, `HTTP/1.0`, `HTTP/1.0+` 등이 있었다.
* 현재는 `HTTP/1.1` 또는 `HTTP/2.0` 이 쓰인다.

### 1.8 웹의 구성요소

* 프락시
  * 클라이언트와 서버 사이에 위치하여 클라이언트의 모든 요청을 받아 서버로 전달. 요청과 응답의 수정 및 필터링 등이 가능하다.
* 캐시
  * 자주 찾는 것의 사본을 저장하는 특별한 종류의 HTTP 프락시 서버. 주로 속도 향상을 위함.
* 게이트웨이
  * 다른 서버들의 중개자로 동작하는 서버. 주로 HTTP 트래픽을 다른 프로토콜로 변환한다. HTTP/FTP 게이트웨이라면 FTP URI에 대한 HTTP 요청을 받아 FTP 프로토콜을 이용해 요청을 처리한다.
* 터널
  * 두 커넥션 사이에서 데이터를 열어보지 않고 그대로 전달하는 HTTP 애플리케이션. 주로 비 HTTP 데이터를 하나 이상의 HTTP 연결을 통해 전송하기 위해 사용함. HTTP/SSL 터널이라면 HTTP 기반으로 커넥션을 맺고 이후부터 암호화된 SSL 트래픽을 HTTP 채널을 통해 전송할 수 있음
* 에이전트
  * 사용자를 위해 HTTP 요청을 만들어주는 클라이언트 프로그램
  * 브라우저, 자동화된 웹로봇 등.
